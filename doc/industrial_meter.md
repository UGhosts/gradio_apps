# 工业仪表智能读数应用

## 应用介绍

工业仪表智能读数应用是一个基于深度学习的自动化检测工具，专门设计用于从工业环境中的指针式仪表（如压力表）图像中自动提取读数。该应用利用目标检测和语义分割技术，能够精确定位仪表位置并解析其指针指示的数值，极大地提高了工业巡检的效率和准确性。

### 主要功能

- **自动化仪表检测**：使用先进的目标检测模型自动识别图像中的仪表位置。
- **高精度读数解析**：通过语义分割技术分离仪表指针和刻度，结合几何算法计算精确读数。
- **多模型支持**：支持灵活选择不同的检测器（如 PP-YOLOE_plus-S）和分割器（如 SegFormer-B1）模型。
- **参数动态调整**：用户可实时调整检测置信度、形态学腐蚀等参数，以适应不同的图像质量和环境条件。
- **直观的可视化**：在原图上绘制检测框并标注读数，同时提供详细的文本结果和摘要。

## 模型介绍

该应用采用了两阶段的深度学习处理流程：首先进行目标检测，然后对检测到的仪表进行语义分割和读数计算。

### 模型特点

- **目标检测 (Detector)**：
  - 采用 **PP-YOLOE_plus-S** 模型，具有高精度和快速推理的特点，能够在复杂背景下准确锁定仪表区域。
- **语义分割 (Segmenter)**：
  - 采用 **SegFormer-B1** 模型，负责将仪表图像分割为指针、刻度盘等不同语义区域。
- **读数算法**：
  - **坐标转换**：将圆形仪表图像转换为矩形展开图（极坐标到笛卡尔坐标变换）。
  - **1D 投影分析**：通过将二维图像投影为一维信号，精确定位刻度和指针位置。
  - **均值过滤**：内置自适应均值过滤算法，有效去除刻度识别中的噪声干扰。

### 使用方法

1. **模型配置**：
   - 在左侧“模型配置”区域，分别选择合适的“检测模型”和“分割模型”。
2. **上传图片**：
   - 点击“上传图片”区域上传本地仪表照片，或从上方的“示例图片”画廊中选择一张进行测试。
3. **调整参数**（可选）：
   - **检测置信度阈值**：调整滑块以过滤低置信度的检测结果（默认 0.5）。
   - **形态学腐蚀**：勾选“使用形态学腐蚀”并调整核大小，以优化分割边缘（默认开启，核大小 4）。
4. **开始读数**：
   - 点击“🔍 开始读数”按钮，等待系统处理。
5. **查看结果**：
   - 右侧将显示处理后的图片（包含检测框和读数标注）、检测摘要以及每个仪表的详细读数。

### 模型选择说明

应用会自动扫描 `model/industrail_metric_det/model` 目录下的可用模型。目前主要支持的模型组合如下：

| 模型类型 | 模型名称 | 用途 |
|----------|----------|------|
| Detector | PP-YOLOE_plus-S | 检测图像中的仪表位置 |
| Segmenter | SegFormer-B1 | 分割仪表内部的指针和刻度 |

### 结果解释

- **可视化结果**：
  - **绿色边框**：表示检测到的仪表范围。
  - **绿色文字**：显示该仪表的编号及计算出的压力值（单位：MPa）。
- **文本结果**：
  - **检测摘要**：简要说明检测到的仪表总数及成功读取的数量。
  - **详细结果**：列出每个仪表的具体读数（例如 `仪表 1: 0.450 MPa`），若无法读取则显示提示信息。
