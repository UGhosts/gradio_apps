# 空压机故障分类预测完整解决方案
## 1. 系统架构设计
### 1.1 整体架构
系统采用云边协同的分布式架构，通过分层设计实现数据从采集到应用的全流程高效处理，各核心层功能及细节如下：
#### 1.1.1 感知层
感知层作为系统的数据入口，承担着设备运行状态数据的采集与初步处理任务。
- **传感器网络**：选用振动、温度、压力、电流等多类型传感器，具体型号可结合实际场景选择，例如温度传感器采用PT100，具备高精度和稳定性；振动传感器选用压电式，能精准捕捉设备振动信号。这些传感器全面覆盖空压机关键运行部位，为故障分析提供多维度数据支撑。
- **数据采集器**：深度支持Modbus RTU/TCP等主流工业协议，其中Modbus RTU适用于近距离串行通信，Modbus TCP则适配网络环境下的远程数据采集，可灵活应对不同工业现场的通信需求，确保数据采集的兼容性和广泛性。
- **边缘计算节点**：采用工业级边缘网关，搭载高性能处理器，可实现实时数据预处理和初步分析。硬件配置上支持多协议转换和本地存储，软件层面集成数据处理算法，有效降低云端数据传输压力，提升数据处理的实时性。

#### 1.1.2 网络层
网络层负责数据的安全、稳定传输，搭建有线与无线结合的多元化传输网络。
- **工业以太网**：采用千兆工业以太网，基于TCP/IP协议，具有低延迟、高带宽的特点，能满足海量传感器数据的实时传输需求，保障数据传输的可靠性，适用于厂房内固定设备的数据传输。
- **5G/WiFi6**：提供无线数据传输方案，5G技术具备高速率、低时延、广连接的优势，适合移动场景或布线困难的区域；WiFi6则在局域网内实现高并发数据传输，两种技术互补，提升网络覆盖的灵活性。
- **数据安全网关**：集成防火墙、数据加密、访问控制等功能，对传输数据进行AES加密处理，同时设置严格的访问权限策略，仅授权设备和用户可访问数据，有效防范数据泄露、篡改等安全风险。

#### 1.1.3 平台层
平台层是系统的核心处理中心，提供数据存储、计算资源和模型管理能力。
- **数据存储**：采用时序数据库TDengine与对象存储（如MinIO）组合的存储方案。TDengine专门优化时序数据存储，支持高写入性能和快速查询，适用于存储高频采集的传感器数据，并可配置数据保留策略；对象存储用于存储设备运行日志、模型文件等非结构化数据，具备高可靠性、高扩展性。
- **计算资源**：部署GPU集群与分布式计算框架Spark，GPU集群选用NVIDIA GPU，具备强大的并行计算能力，满足深度学习模型训练的算力需求；Spark框架支持海量数据的分布式处理，可高效完成数据预处理、特征工程等计算任务。
- **模型管理**：构建全生命周期模型管理平台，涵盖模型训练、部署、更新等环节。支持多版本模型存储与对比，提供模型在线部署接口，可根据新数据自动触发模型更新流程，确保模型预测性能的稳定性和时效性。

#### 1.1.4 应用层
应用层面向用户提供多样化的功能服务，助力设备运维管理。
- **实时监控**：通过可视化界面实时展示空压机运行状态，包括各项传感器参数、设备工作模式等，支持设备定位、参数超限标记等功能，方便用户直观掌握设备运行情况。
- **故障预警**：基于模型预测结果，及时发现设备潜在故障，通过弹窗、声音等方式发出预警提示，并详细展示故障类型、关键特征参数等信息，为用户争取故障处理时间。
- **维护决策**：结合故障类型、设备运行年限、备品备件库存等信息，生成个性化维护建议，包括维护时间、维护流程、所需备件等，同时优化维护资源分配，降低运维成本。

### 1.2 技术栈选择
| 技术层次 | 核心技术 | 选型理由 | 补充细节 |
| --- | --- | --- | --- |
| 数据采集 | Modbus 协议（RTU/TCP）、OPC UA | 工业标准协议，兼容性强 | Modbus协议成熟稳定，广泛应用于工业设备；OPC UA支持跨平台、跨厂商通信，具备良好的扩展性，适用于复杂工业场景的数据交互 |
| 边缘计算 | Python、C++ | 高性能计算，实时处理能力 | Python借助NumPy、SciPy等库实现数据处理算法快速开发；C++在底层控制和高效计算方面优势明显，可满足边缘节点实时性要求 |
| 数据存储 | TDengine、MinIO | 时序数据优化，对象数据存储 | TDengine针对时序数据的写入和查询进行专项优化，支持高并发操作；MinIO则作为对象存储，提供高可靠、高扩展性的存储解决方案，适用于存储非结构化数据，如模型文件、运行日志等 |
| 机器学习 | TensorFlow、PyTorch | 深度学习框架，模型丰富 | TensorFlow在工业级部署和分布式训练方面表现出色，适合CNN等模型的实现；PyTorch灵活性高，在迁移学习、模型调试等场景中应用广泛 |
| 可视化 | Grafana、ECharts | 工业级可视化，实时展示 | Grafana支持自定义仪表盘，可快速配置设备监控界面；ECharts提供丰富的动态图表类型，如折线图、柱状图等，适合数据趋势分析展示 |

## 2. 数据采集方案
### 2.1 传感器配置方案
基于6090运行参数及Modbus协议，结合空压机运行特性，优化传感器配置，确保数据采集的全面性和准确性。

#### 2.1.1 核心传感器清单
| 传感器类型 | 监测位置 | 监测参数 | 采集频率 | 精度要求 | 补充说明 |
| --- | --- | --- | --- | --- | --- |
| 温度传感器（PT100） | 排气口、轴承、电机绕组 | 温度 (°C) | 1Hz | ±1°C | 选用PT100铂电阻传感器，耐温范围广、稳定性强，能适应空压机高温运行环境 |
| 压力传感器（扩散硅式） | 供气口、储气罐、油分压差 | 压力 (MPa) | 10Hz | ±0.5% | 扩散硅式传感器灵敏度高，可精准捕捉压力细微变化，满足供气系统压力监测需求 |
| 电流传感器（霍尔式） | 主机电机、风机电机 | 三相电流 (A) | 50Hz | ±1% | 霍尔式传感器响应速度快，能实时监测电机电流变化，及时发现电机过载等异常 |
| 功率传感器 | 主电路 | 有功功率、功率因数 | 50Hz | ±0.5% | 具备宽电压、宽电流测量范围，适配空压机主电路的功率参数监测 |
| 流量传感器（涡街式） | 主管路 | 压缩空气流量 (m³/min) | 1Hz | ±2% | 涡街式传感器结构简单、可靠性高，适合工业管道内的流量测量 |

#### 2.1.2 关键监测点分布
- **主机系统**：前轴承温度（寄存器地址:16）、后轴承温度（寄存器地址:62）是设备机械磨损的关键监测指标，温度过高会加速轴承老化，严重时导致设备停机；排气温度（寄存器地址:1）直接影响压缩空气品质和设备能耗；主机电流（寄存器地址:4-6）反映电机负载情况，是判断电机是否过载的核心参数。
- **润滑系统**：油分压差（寄存器地址:63）过大表明油分滤芯堵塞，会增加能耗并影响润滑效果；各过滤器使用时间（寄存器地址:10-14）用于判断过滤器是否需要更换，避免杂质进入系统造成设备损坏。
- **电气系统**：三相电压（寄存器地址:24）不稳定会影响电机运行稳定性，可能导致设备故障；输出功率（寄存器地址:35、39）反映设备能耗水平，为节能优化提供数据支撑。

### 2.2 数据采集策略
#### 2.2.1 采集频率优化
采用动态采集频率策略，根据设备运行状态灵活调整采集频率，在保证数据质量的同时降低资源消耗。
- **正常状态**：采用基础采集频率（1-10Hz），此时设备参数稳定，无需高频采集，可减少数据存储和传输压力。
- **异常状态**：当参数超过正常阈值的80%时，切换至高频采集模式（100Hz-1kHz），重点捕捉参数变化趋势，为故障预警提供精准数据。
- **故障状态**：参数超过故障阈值时，启动最高采集频率（1kHz以上），全面记录故障发生过程中的数据变化，为故障分析和模型优化提供详细数据。

#### 2.2.2 数据传输协议
基于Modbus RTU协议优化通信参数，提升数据传输的稳定性和准确性。
- 波特率设置为9600bps，在保证传输速率的同时降低误码率；数据位8位、停止位1位为工业通信常用配置，兼容性强；偶校验可有效检测传输过程中的单比特错误；超时时间500ms根据工业环境传输延迟特性设置，避免因网络延迟导致数据丢失。

#### 2.2.3 边缘计算预处理
在边缘节点完成数据预处理工作，提升数据质量并降低云端处理压力。
- **数据清洗**：采用3σ准则去除异常值，对于连续缺失≤3个的数据采用线性插值填充，连续缺失>3个的数据基于K近邻算法找到相似运行工况下的数据填充，关键参数缺失时立即触发设备检查告警，确保数据完整性。
- **特征提取**：计算时域特征如均值、峰值、峭度等，以及频域特征如频谱峰值、谐波含量等，挖掘数据中的故障信息。
- **数据压缩**：采用霍夫曼编码算法对数据进行压缩，减少数据传输带宽需求，同时保证数据解压后不丢失关键信息。
- **初步诊断**：基于规则进行异常检测，例如电流超过额定值的105%、温度上升速率超过1°C/min等情况，直接判定为异常并标记，为后续故障预测提供初步判断。

## 3. 数据预处理与特征工程
### 3.1 数据预处理流程
#### 3.1.1 数据清洗
数据清洗是提升数据质量的关键环节，针对不同数据问题采用针对性处理方法。
- **缺失值处理**：连续缺失≤3个时，采用线性插值方法，利用相邻数据的线性关系补充缺失值，保持数据的连续性；连续缺失>3个时，基于K近邻算法，根据设备运行工况（如负载、环境温度等）找到历史相似数据片段进行填充；关键参数（如主机电流、排气温度）缺失时，立即触发设备检查告警，通知运维人员排查传感器或设备故障。
- **数据平滑**：温度信号受环境干扰较小，采用窗口大小为5的移动平均滤波，平滑数据波动；压力信号易受气流冲击影响，采用卡尔曼滤波，通过动态调整滤波参数，精准跟踪压力变化趋势，降低噪声干扰。

#### 3.1.2 数据标准化
采用Z-score标准化方法对数据进行处理，计算公式为\(z = \frac{x - \mu}{\sigma}\)，其中\(x\)为原始数据，\(\mu\)为数据均值，\(\sigma\)为数据标准差。该方法能将不同量纲、不同数量级的特征数据转换为均值为0、标准差为1的标准化数据，消除量纲差异对模型训练的影响，提升模型收敛速度和预测精度，适用于本系统中多类型传感器数据的统一处理。

### 3.2 特征工程
#### 3.2.1 时域特征提取
通过提取时域特征，挖掘数据中的统计规律和变化趋势，为故障预测提供特征支撑。
- **统计特征**：均值反映数据的平均水平，可用于判断参数是否处于正常范围；标准差和方差体现数据的离散程度，参数波动过大可能预示设备异常；最大值、最小值、峰值能捕捉数据的极端情况，如电机电流峰值过高可能是过载的前兆；偏度、峰度、峭度用于描述数据分布特性，峭度高表明数据中存在较多冲击信号，可能与设备机械故障相关；波形因子、峰值因子、脉冲因子可反映信号的形态特征，用于区分不同类型的故障信号。
- **趋势特征**：线性趋势系数通过最小二乘法拟合数据趋势线得到，正系数表明参数呈上升趋势，可能存在故障隐患；移动平均偏差反映数据与移动平均线的偏离程度，偏差过大说明参数变化不稳定；指数平滑预测误差用于评估数据的预测准确性，为后续故障预测模型优化提供依据，平滑系数根据数据变化频率设置为0.2-0.5。

#### 3.2.4 故障特征库
| 故障类型 | 关键特征指标 | 预警级别 | 补充说明 |
| :--- | :--- | :--- | :--- |
| **主机过载** | 主电机总功耗差分 (高于基线190%) | **高** | 主机负载严重超限，通常由排气压力过高、轴承磨损或气缸故障导致。高预警需立即通知运维人员停机检查，防止电机烧毁。 |
| **主机不平衡** | 电流平衡度 (高于基线170%) | **高** | 电机三相电流不平衡度异常升高，可能伴随电流/电压的剧烈波动。需紧急排查电源侧或电机绕组问题，避免设备剧烈振动。 |
| **风机过载** | 风机总功耗差分 (高于基线180%) | **高** | 风机负载超限，可能因冷却器或风道堵塞、风机本身故障引起。高预警需立即检查冷却散热系统。 |
| **排气温度高** | 排气温度 (高于基线140%) | **中等** | 排气温度持续升高，可能因油位低、冷却系统效率下降或温控阀故障导致。中等预警需在24小时内安排检查和维护，防止高温停机。 |
| **供气压力高** | 供气压力 (高于基线130%) | **中等** | 供气压力异常升高，通常表示管网阻力增加或压力调节系统故障。需在48小时内检查用气端和压力控制阀。 |
| **电压过低** | 电压 (低于基线85%) | **高** | 电源输入电压低于设备最低安全运行电压，可能导致电机运行电流超高。高预警需立即检查外部供电系统，防止电机过载烧毁。 |
| **电压过高** | 电压 (高于基线112%) | **中等** | 电源输入电压高于设备额定电压，可能对变频器等电气元件造成损害。需尽快通知电工调整供电电压。 |

## 4. 故障分类预测模型
### 4.1 模型架构设计
采用多模型融合的集成学习架构，结合多个基础模型的优势，提升故障分类预测的准确性和稳定性。

#### 4.1.1 基础模型层
- **分类模型**
  - 支持向量机（SVM）：选用RBF核函数，在小样本数据分类中表现优异，可有效处理空压机故障样本稀缺的场景，准确区分不同类型的故障。
  - 随机森林：由100棵决策树组成，能评估特征重要性，筛选对故障预测关键的特征，提升模型解释性，同时降低过拟合风险。
  - XGBoost：采用梯度提升策略，具备强大的高维特征处理能力，能捕捉特征之间的复杂非线性关系，适用于本系统中多特征融合的故障分类任务。
  - 卷积神经网络（CNN）：采用3层卷积层和2层全连接层的结构，擅长提取数据的局部特征，可从振动、电流等时序数据中挖掘深层次的故障特征。
- **异常检测模型**
  - 孤立森林：基于决策树构建，适用于无监督异常检测场景，能快速识别数据中的异常样本，对未知故障具有一定的检测能力。
  - 自编码器：采用编码器-解码器结构，通过重构正常数据训练模型，当输入异常数据时重构误差增大，从而实现异常检测，对非线性异常信号敏感。
  - One-Class SVM：仅通过正常数据训练模型，构建正常数据的边界，适用于单类分类场景，可有效检测偏离正常运行状态的异常情况。

### 4.3 故障分类体系
#### 4.3.1 故障分类层次
基于空压机的结构组成和运行原理，构建二级故障分类体系，该分类结果基于5年历史故障数据统计得出。
- **一级分类（4大类）**
  1. 电气系统故障（占比35%）：主要包括电机过载、三相电压不平衡、电气元件损坏等，多由电源异常、负载过大等原因导致。
  2. 机械系统故障（占比30%）：涵盖轴承故障、转子故障、气阀故障等，与设备机械磨损、安装精度等因素相关。
  3. 控制系统故障（占比20%）：如传感器故障、PLC逻辑错误、控制程序异常等，会影响设备的控制精度和运行稳定性。
  4. 环境因素故障（占比15%）：包括环境温度过高、粉尘污染、湿度超标等，外部环境变化对设备运行产生不利影响。
- **二级分类（16小类）**：在一级分类基础上进一步细分，具体包括电机过载、轴承故障、转子故障、气阀故障、油分堵塞、冷却器堵塞、传感器故障、PLC逻辑错误、环境温度过高、粉尘污染等，每类故障对应明确的故障特征和处理方式。

#### 4.3.2 故障严重程度分级
根据故障对设备运行的影响程度，划分故障严重等级并制定相应的处理策略。
| 严重等级 | 影响程度 | 响应时间 | 处理策略 | 示例 |
| --- | --- | --- | --- | --- |
| A 级 | 紧急停机 | 立即 | 启动紧急维修流程，安排运维人员第一时间到达现场处理，同时切换备用设备，避免生产中断 | 电机短路、轴承抱死 |
| B 级 | 性能下降 | 24 小时内 | 制定计划维修方案，协调运维资源，在不影响正常生产的前提下完成维修 | 油分堵塞导致供气效率下降、冷却器散热效果变差 |
| C 级 | 轻微异常 | 72 小时内 | 持续监控设备运行状态，记录参数变化趋势，若异常加剧则升级处理 | 环境粉尘轻微超标、传感器数据小幅波动 |
| D 级 | 潜在风险 | 1 周内 | 实施预防性维护，及时更换老化部件、清理设备杂质，消除故障隐患 | 过滤器使用时间接近寿命上限、润滑油油位偏低 |

## 5. 模型训练与优化
### 5.1 数据集构建
#### 5.1.1 数据采集计划
构建高质量的数据集是模型训练的基础，明确数据采集的范围和标准。
- **训练数据集**：正常数据需采集至少6个月的连续运行数据，涵盖不同季节、不同负载工况，确保数据的多样性；故障数据收集至少50个完整故障案例，包括故障发生前、发生中、发生后的全流程数据，涵盖各类常见故障类型；边缘数据选取20个边界工况案例，如最低环境温度、最高负载、电压波动极限等场景，提升模型对极端工况的适应能力。
- **测试数据集**：采用独立的3个月运行数据，避免与训练数据重叠，确保测试结果的客观性；数据中包含10个未见过的故障案例，用于验证模型对未知故障的预测能力。

#### 5.1.2 数据增强技术
针对故障样本稀缺的问题，采用多种数据增强技术扩充故障样本数量。
- 采用SMOTE算法生成合成故障样本，通过在相邻故障样本之间插值，构建新的故障数据；
- 对时间序列数据进行平移、缩放、翻转等变换，模拟不同工况下的故障信号；
- 引入噪声添加技术，在原始故障数据中加入适量高斯噪声，提升模型的抗干扰能力。

### 5.2 训练策略
#### 5.2.1 迁移学习
利用预训练模型加速训练过程，提升模型性能。
- 首先在公开的工业设备故障通用数据集上对基础模型进行预训练，使模型掌握通用的故障特征提取能力；
- 然后将预训练模型迁移到空压机特定数据集上进行微调，冻结底层特征提取层，仅训练顶层分类层，减少训练参数数量，缩短训练时间；
- 微调过程中设置学习率为0.001，迭代次数为100轮，采用交叉熵损失函数优化模型参数。

#### 5.2.3 交叉验证
采用时间序列交叉验证方法，避免数据泄露，提升模型的稳定性。
- 按照时间顺序将数据分割为多个连续的子集，确保训练集的时间在前，测试集的时间在后，模拟真实的预测场景；
- 采用滑动窗口验证方式，窗口大小设置为1个月，每次滑动半个月，进行多折验证（5折）；
- 计算各折验证的性能指标，取平均值作为模型的最终性能评估结果，减少偶然因素对模型评估的影响。

### 5.3 模型优化
#### 5.3.1 超参数优化
采用贝叶斯优化方法对模型超参数进行寻优，提高模型性能。
- 确定超参数搜索空间，例如SVM的核函数参数\(\gamma\)搜索范围为0.001-10，随机森林的决策树数量搜索范围为50-200，XGBoost的学习率搜索范围为0.001-0.1；
- 基于高斯过程模型构建超参数与模型性能之间的映射关系，通过迭代采样寻找最优超参数组合，最终确定的超参数使模型F1分数提升5%以上。

#### 5.3.2 特征选择
基于特征重要性筛选关键特征，降低模型复杂度，提升训练效率。
- 利用随机森林模型计算特征重要性得分，排序后选取得分前80%的特征；
- 采用递归特征消除（RFE）方法，逐步剔除对模型性能贡献较小的特征，保留最优特征子集；
- 结合L1正则化方法，对特征权重进行惩罚，使不重要特征的权重趋于0，实现特征自动选择，最终特征数量减少40%，模型训练时间缩短30%。

#### 5.3.3 模型压缩
对训练好的模型进行轻量化处理，满足边缘节点的部署需求。
- **知识蒸馏**：以训练好的复杂集成模型作为教师模型，训练一个结构简单的学生模型，使学生模型学习教师模型的预测分布，在保证预测精度损失不超过3%的前提下，模型体积缩小70%。
- **量化**：采用INT8/FP16量化方法，将模型参数从32位浮点数转换为8位整数或16位浮点数，减少模型存储空间和计算量，量化后模型推理速度提升2倍。
- **剪枝**：通过通道剪枝和权重剪枝，剔除模型中冗余的通道和权重参数，剪枝比例设置为30%，在不影响模型性能的前提下，进一步降低模型复杂度。

## 6. 性能评估指标
### 6.1 预测性能指标
采用多维度指标评估模型的故障分类预测性能，明确各指标的目标值和考核标准。
| 指标名称 | 计算公式 | 目标值 | 说明 |
| --- | --- | --- | --- |
| 准确率 (Accuracy) | (TP+TN)/(TP+TN+FP+FN) | ≥95% | 衡量模型整体分类准确性，反映模型对正常和故障样本的正确识别能力，目标值基于行业先进水平设定 |
| 精确率 (Precision) | TP/(TP+FP) | ≥90% | 体现故障预测的精准度，减少误报情况，降低不必要的运维成本，确保预警信息的可靠性 |
| 召回率 (Recall) | TP/(TP+FN) | ≥90% | 表示故障检测的覆盖率，尽量避免漏报故障，确保所有潜在故障都能被及时发现 |
| F1 分数 (F1-Score) | 2×Precision×Recall/(Precision+Recall) | ≥90% | 综合考虑精确率和召回率，平衡误报和漏报问题，是模型综合性能的核心评价指标 |
| AUC 值 | ROC 曲线下面积 | ≥0.95 | 用于评估二分类模型的区分能力，AUC值越接近1，模型对正负样本的区分能力越强 |

### 6.2 系统性能指标
#### 6.2.1 实时性指标
确保系统在数据处理和故障响应方面具备高效的实时性能。
| 指标名称 | 目标值 | 测试方法 | 说明 |
| --- | --- | --- | --- |
| 数据采集延迟 | ≤100ms | 时间戳对比法，在传感器端和采集器端分别记录数据采集时间，计算时间差 | 保证传感器数据能及时传输至系统，为实时监控和预警提供时间保障 |
| 预处理时间 | ≤1 秒 | 性能测试工具模拟数据输入，记录边缘节点完成预处理的时间 | 快速完成数据清洗、特征提取等操作，避免数据积压 |
| 模型推理时间 | ≤10 秒 | 压力测试，同时输入多组数据，统计模型输出预测结果的平均时间 | 确保故障能被快速识别，为故障处理争取时间 |
| 告警响应时间 | ≤30 秒 | 端到端测试，模拟故障场景，记录从模型预测故障到发出告警提示的总时间 | 及时通知用户处理故障，降低故障造成的损失 |

#### 6.2.2 可靠性指标
保障系统长期稳定运行，提升用户信任度。
| 指标名称 | 目标值 | 测试方法 | 说明 |
| --- | --- | --- | --- |
| 系统可用性 | ≥99.9% | 统计系统一年的运行时间和故障停机时间，可用性=（总运行时间-故障停机时间）/总运行时间 | 确保系统在工业生产环境中持续提供服务，减少因系统故障导致的生产中断 |
| 误报率 | ≤3% | 分析历史告警数据，误报率=误报次数/总告警次数 | 降低误报对用户的干扰，避免不必要的运维工作 |
| 漏报率 | ≤1% | 通过故障案例验证，漏报率=漏报次数/总故障次数 | 确保故障不被遗漏，全面保障设备运行安全 |
| 数据完整性 | ≥99.5% | 数据校验统计，对比传感器采集数据和系统存储数据的数量，计算完整性比例 | 保证数据不丢失，为模型训练和故障分析提供可靠的数据支撑 |