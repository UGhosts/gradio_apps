# 智能仪表自动读数解决方案

## 1. 概述
在工业现场，大量压力表、流量计等模拟仪表仍需人工巡检读数，效率低且易出错。本方案基于深度学习视觉识别技术，实现对工业指针式仪表的自动检测、定位、分割与读数转换。通过手机拍摄或摄像头固定监控，系统可秒级输出精确读数，极大提升了数字化管理的效率。

## 2. 数据采集方案
由于本方案基于计算机视觉技术，数据采集的核心在于高质量图像的获取。

### 2.1 硬件选型
| 设备名称 | 推荐型号 | 关键参数 | 适用场景 |
|---|---|---|---|
| **固定式摄像头** | 海康威视 (Hikvision) 7系列 AI 筒机 | 400万像素, 4mm-12mm 变焦 | 长期固定位置监控 |
| **手持终端** | 工业级防爆智能手机 (如 三防系列) | 1200万像素, 支持自动对焦 | 人工巡检抽检 |
| **补光设备** | LED 工业条形补光灯 | 5000K 色温, 无频闪 | 光线阴暗或夜间环境 |

### 2.2 采集规范
- **安装位置**：摄像头应正对仪表盘中心，垂直偏差角度建议在 ±15° 以内。
- **成像要求**：仪表盘在图像中的占比不应低于 1/4，刻度与指针需清晰可见，避免玻璃表面反光遮挡关键刻度。
- **网络传输**：通过 RTSP 协议或 ONVIF 协议将实时流推送到计算服务器。

## 3. 方案架构
本系统采用两阶段视觉识别架构：
- **目标检测阶段**：使用 PP-YOLOE+ 模型检测图像中的仪表位置。
- **语义分割阶段**：对检测到的仪表区域进行二次处理，使用 SegFormer 模型提取指针（Pointer）和刻度（Scale）的像素级位置。
- **后处理阶段**：利用几何算法将像素坐标转换为角度，最终根据量程配置计算出物理读数。

## 3. 数据准备
### 3.1 模型输入
- **图像格式**：支持 JPG, PNG, BMP 等主流格式。
- **场景覆盖**：覆盖不同光照、角度、遮挡及复杂背景下的仪表图像。

### 3.2 仪表配置
系统支持多种量程配置，例如：
- 0-25 MPa (单位: MPa)
- 0-1.6 MPa (单位: MPa)
系统通过检测到的刻度数量自动适配对应的量程范围。

## 4. 模型开发
### 4.1 检测模型 (Detector)
- **算法**：PP-YOLOE+ S 
- **作用**：在复杂场景中精准定位一个或多个仪表盘。

### 4.2 分割模型 (Segmenter)
- **算法**：SegFormer-B1
- **作用**：对仪表盘内部进行三类分割：背景、指针、刻度。

### 4.3 读数算法
1. **展开映射**：将圆形的仪表盘展开为矩形线性图像。
2. **一维投影**：将指针和刻度的位置投影到一维空间。
3. **均值过滤**：消除分割噪声对读数的影响。
4. **比例计算**：根据指针相对于起始/结束刻度的相对位置，结合量程系数计算读数。

## 5. 部署与可视化
- **交互界面**：基于 Gradio 构建，支持实时上传、模型切换及参数微调（如检测置信度、腐蚀核大小）。
- **可视化标注**：在原图上绘制检测框，并实时标注识别出的读数值。
- **形态学处理**：集成形态学腐蚀操作，减少分割碎片噪声，提升读数稳定性。
